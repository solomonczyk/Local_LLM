# üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è Agent System

## Local HTTPS (self-signed, Docker)
```bash
docker compose --profile https up -d nginx-https
# UI: https://localhost:8443
```
## üéØ –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–≥–µ–Ω—Ç—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–µ –ø–æ HTTPS.

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (2 –º–∏–Ω—É—Ç—ã)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
chmod +x quick-https.sh
./quick-https.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
```bash
scp nginx-https.conf setup-https.sh root@152.53.227.37:/root/
```

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
```bash
ssh root@152.53.227.37
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É:**
```bash
cd /root
chmod +x setup-https.sh
sudo ./setup-https.sh
```

## üîß –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç certbot** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
2. **–ü–æ–ª—É—á–∞–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –æ—Ç Let's Encrypt –¥–ª—è –¥–æ–º–µ–Ω–æ–≤:
   - `152.53.227.37.nip.io`
   - `agent.152.53.227.37.nip.io`
   - `api.152.53.227.37.nip.io`
   - `llm.152.53.227.37.nip.io`
   - `tools.152.53.227.37.nip.io`
3. **–û–±–Ω–æ–≤–ª—è–µ—Ç nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –¥–ª—è HTTPS
4. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
5. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã** —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üåê –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã HTTPS —Å—Å—ã–ª–∫–∏:

| –°–µ—Ä–≤–∏—Å | HTTPS URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|----------|
| **üñ•Ô∏è Agent UI** | https://agent.152.53.227.37.nip.io | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| **ü§ñ LLM API** | https://api.152.53.227.37.nip.io | API —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ |
| **üîß Tools API** | https://tools.152.53.227.37.nip.io | API –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è:
- ‚úÖ **SSL/TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ **HTTP ‚Üí HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **Security headers** (HSTS, XSS Protection, etc.)
- ‚úÖ **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS
- ‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ SSL –ø—Ä–æ—Ç–æ–∫–æ–ª—ã** (TLS 1.2, 1.3)

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:
- üÜì **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π** –æ—Ç Let's Encrypt
- ‚è∞ **–î–µ–π—Å—Ç–≤—É–µ—Ç 90 –¥–Ω–µ–π** —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ cron
- üåç **–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–π** –≤—Å–µ–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS
nslookup 152.53.227.37.nip.io

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ 80
sudo netstat -tlnp | grep :80

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä—É–≥–∏–µ –≤–µ–±-—Å–µ—Ä–≤–∏—Å—ã
sudo systemctl stop apache2 nginx
```

### –ï—Å–ª–∏ nginx –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
sudo docker logs agent-nginx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot certificates

# –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo certbot renew --dry-run
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot renew

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å nginx
docker compose restart nginx
```

## üìã –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] https://agent.152.53.227.37.nip.io –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–µ–ª–µ–Ω—ã–π –∑–∞–º–æ–∫ üîí
- [ ] HTTP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ HTTPS
- [ ] API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ HTTPS
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω (–Ω–µ –∏—Å—Ç–µ–∫)

## üÜò –û—Ç–∫–∞—Ç –∫ HTTP

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ HTTP:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose down

# –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cp nginx.conf.backup nginx.conf

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ SSL
docker compose up -d
```

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

### Cloudflare (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω
2. –î–æ–±–∞–≤—å—Ç–µ –≤ Cloudflare
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS –∑–∞–ø–∏—Å–∏
4. –ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL –æ—Ç Cloudflare

### Self-signed —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout selfsigned.key -out selfsigned.crt
```

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –¢–µ–ø–µ—Ä—å –≤–∞—à–∞ –∞–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É HTTPS –ø—Ä–æ—Ç–æ–∫–æ–ª—É.